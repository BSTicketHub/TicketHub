@model TicketHubApp.Models.ViewModels.HomeListViewModel
@{
    ViewBag.Title = "TicketHub";
}

<div class="position-relative">
    <div class="banner-img">
        <img class="w-100" src="/Assets/Images/Home/studioBanner.jpg" alt="">
    </div>
    <div class="content-box">
        <div class="title-block">
            <h1 class="text-white text-md-6 font-weight-bolder p-2">盡情揮灑生活的色彩，更多票劵等待發現</h1>
            <p class="text-white text-sm-9 font-weight-bolder">規劃不一樣的旅程，探索近在咫尺的美食。</p>
        </div>
        <div class="search-bar d-flex justify-content-center p-2">
            <div class="dropdown">
                <a class="font-weight-bolder text-md-2 hov-color-cust" data-toggle="dropdown">
                    探索城市
                    <span class="iconify" data-icon="dashicons:arrow-down-alt2" data-inline="false"></span>
                </a>
                <ul class="dropdown-menu dropdown-menu-col-2 text-sm-9 border-0">
                    <li class="dropdown-item active-color-cust active">@Html.ActionLink("台北", "ShopList", "Customer", new { input = "台北市" }, new { @class = "rounded hov-color-cust" })</li>
                    <li class="dropdown-item active-color-cust">@Html.ActionLink("基隆", "ShopList", "Customer", new { input = "基隆市" }, new { @class = "rounded hov-color-cust" })</li>
                    <li class="dropdown-item active-color-cust">@Html.ActionLink("新北", "ShopList", "Customer", new { input = "新北市" }, new { @class = "rounded hov-color-cust" })</li>
                    <li class="dropdown-item active-color-cust">@Html.ActionLink("宜蘭", "ShopList", "Customer", new { input = "宜蘭縣" }, new { @class = "rounded hov-color-cust" })</li>
                    <li class="dropdown-item active-color-cust">@Html.ActionLink("桃園", "ShopList", "Customer", new { input = "桃園市" }, new { @class = "rounded hov-color-cust" })</li>
                    <li class="dropdown-item active-color-cust">@Html.ActionLink("台中", "ShopList", "Customer", new { input = "台中市" }, new { @class = "rounded hov-color-cust" })</li>
                    <li class="dropdown-item active-color-cust">@Html.ActionLink("台南", "ShopList", "Customer", new { input = "台南市" }, new { @class = "rounded hov-color-cust" })</li>
                    <li class="dropdown-item active-color-cust">@Html.ActionLink("高雄", "ShopList", "Customer", new { input = "高雄市" }, new { @class = "rounded hov-color-cust" })</li>
                </ul>
            </div>
            <div class="dropdown ml-5">
                <a class="font-weight-bolder text-md-2 hov-color-cust" data-toggle="dropdown">
                    探索美食
                    <span class="iconify" data-icon="dashicons:arrow-down-alt2" data-inline="false"></span>
                </a>
                <ul class="dropdown-menu dropdown-menu-col-3 text-sm-9 border-0">
                    <li class="dropdown-item active-color-cust active"><a href="">中式料理</a></li>
                    <li class="dropdown-item active-color-cust"><a href="" class="rounded hov-color-cust">韓式料理</a></li>
                    <li class="dropdown-item active-color-cust"><a href="" class="rounded hov-color-cust">日式料理</a></li>
                    <li class="dropdown-item active-color-cust"><a href="" class="rounded hov-color-cust">泰式料理</a></li>
                    <li class="dropdown-item active-color-cust"><a href="" class="rounded hov-color-cust">港式料理</a></li>
                    <li class="dropdown-item active-color-cust"><a href="" class="rounded hov-color-cust">義式料理</a></li>
                    <li class="dropdown-item active-color-cust"><a href="" class="rounded hov-color-cust">蔬食料理</a></li>
                    <li class="dropdown-item active-color-cust"><a href="" class="rounded hov-color-cust">烘培點心</a></li>
                    <li class="dropdown-item active-color-cust"><a href="" class="rounded hov-color-cust">特選餐廳</a></li>
                </ul>
            </div>
        </div>
    </div>
</div>
<div class="container pt-5">
    <div class="row">
        <div class="col-lg-8 col-md-7 col-12 mx-auto mt-2">
            <div class="carousel-autoplay owl-carousel owl-theme">
                <div class="item">
                    <a href="" target="">
                        <img class="img-md2" data-src="" alt="臺灣美食行動Go"
                             src="https://imgur.com/KJmbsd2.jpg">
                    </a>
                </div>
                <div class="item">
                    <a href="" target="">
                        <img class="img-md2" data-src="" alt="消費享回饋"
                             src="https://imgur.com/eky304T.jpg">
                    </a>
                </div>
                <div class="item">
                    <a href="" target="">
                        <img class="img-md2" data-src="" alt="宅配+APP結帳再打75折"
                             src="https://imgur.com/PxbxcoB.jpg">
                    </a>
                </div>
                <div class="item">
                    <a href="" target="">
                        <img class="img-md2" data-src="" alt="假日特賣會"
                             src="https://imgur.com/VpIaAc9.jpg">
                    </a>
                </div>
            </div>
            <div class="d-flex justify-content-around text-center text-muted mt-4">
                <div class="class-icon">
                    <button class="card-shop btn">
                        <img src="/Assets/Images/Home/travel.png" alt="">
                    </button>
                    <h5>地區美食</h5>
                </div>
                <div class="class-icon">
                    <button class="card-shop btn">
                        <img src="/Assets/Images/Home/takeout.png" alt="">
                    </button>
                    <h5>美食外帶</h5>
                </div>
                <div class="class-icon">
                    <button class="card-shop btn">
                        <img src="/Assets/Images/Home/food.png" alt="">
                    </button>
                    <h5>餐廳美食</h5>
                </div>
                <div class="class-icon">
                    <button class="card-shop btn">
                        <img src="/Assets/Images/Home/bed.png" alt="">
                    </button>
                    <h5>熱門美食</h5>
                </div>
            </div>
        </div>
        <div class="col-lg-4 col-md-5 col-12 mx-auto mt-2">
            <div class="rounded border shadow p-2">
                <div class="card-tab">
                    <h5>限時搶購</h5>
                    <div class="d-flex justify-content-start" id="ddCountdown__panel" data-untilts="223313">
                        <div class="timer" id="ddCountdown__hour">62</div>
                        <div class="timer-"> : </div>
                        <div class="timer" id="ddCountdown__min">01</div>
                        <div class="timer-"> : </div>
                        <div class="timer" id="ddCountdown__second">00</div>
                    </div>
                </div>
                <div class="carousel1 owl-carousel owl-theme mt-1">
                    @for (var i = 0; i < 3; i++)
                    {
                        var item = Model.LimitedtimeItems.Items[i];
                        @Html.Partial("_LimitedtimeCard", item)
                    }
                </div>
            </div>
        </div>
    </div>
    <div class="my-5">
        <div class="text-center">
            <h3 class="class-title">超值特選餐廳</h3>
            <div class="class-divider"></div>
        </div>
        <div class="carousel2 owl-carousel mt-4">
            @foreach (var item in Model.BestSellerItems.Items)
            {
                @Html.Partial("_CarouselCard", item)
            }
        </div>
    </div>
    <div class="my-5">
        <div class="text-center">
            <h3 class="class-title">熱賣票劵</h3>
            <div class="class-divider"></div>
        </div>
        <div class="carousel2 owl-carousel mt-4">
            @foreach (var item in Model.RecommenItems.Items)
            {
                @Html.Partial("_CarouselCard", item)
            }
        </div>
    </div>

    <div class="my-5">
        <div class="text-center">
            <h3 class="class-title">最新推出</h3>
            <div class="class-divider"></div>
        </div>
        <div class="row" id="moreCard">
            @for (var i = 0; i < 6; i++)
            {
                var item = Model.SortNewItems.Items[i];
                <div class="col-md-4 col-sm-12">
                    @Html.Partial("_SortNewCard", item)
                </div>
            }
        </div>
    </div>

    <div class="row justify-content-center">
        <div class="col-4 text-center">
            <button class="btn btn-success btn-block" id="showMore" onclick="fetchData()">顯示更多票劵</button>
        </div>
    </div>
</div>
<br>
<br>
<!-- ------ -->
<button class="" id="btnScroll">▲<h6>Top</h6></button>
<!-- ------ -->
@section endJS{
    <script>

        //var show = document.getElementById("cardShow"); //template id
        //body.onload = fetchData(); //在頁面载入完成后 觸發

        function fetchData() {
            var ticketcard;

            $.ajax({
                type: 'GET',
                url: 'CardApi',
                async: false,
                success: function (json) {
                    //json = JSON.parse(json);
                    //genTable(json, parentId, template);
                    console.log(json)
                    alert("123");
                    ticketcard = json.Items
                }
            });

            let card = document.getElementById("moreCard")
            card.innerHTML = "";

            for (var item of ticketcard)
            {
                console.log(item)
                //console.log(item);
                //let CardContent = card.content.cloneNode(true);
                //let a = getElementById("card_a");
                //let img = getElementById("card_img");
                //let title = getElementById("Title");
                //let details = getElementById("detials");

                //CardContent.querySelector("img").src = productCartArray[i].ImgPath;

                let html = `
                    <div class="product-item col-lg-4 col-md-6 col-sm-8">
                        <a href="/ProductDescription/ProductDescription/${item.Id}" target="" id="card_a">
                            <div class="product-img lazyload-img">
                                <img class="img-md img-fluid lazyload" src="${item.ImgPath}"
                                     data-original="" title="${item.Title}" id="card_img">
                                <div class="map-subject">
                                    <div class="label-icon i-map">
                                        <span class="local-tag">信義區</span>
                                    </div>
                                    <div class="label-status">
                                        <span class="status-tag">免預約</span>
                                    </div>
                                </div>
                            </div>
                        </a>
                        <a href="">
                            <div class="wish-btn">
                                <span class="iconify icon-c-white" data-icon="clarity:heart-solid"
                                      data-inline="false"></span>
                            </div>
                        </a>
                        <div class="product-detail">
                            <input type="hidden" id="chart_id" value="${item.Id}">
                            <h3 class="ellipsis" id="Title">${item.Title}</h3>
                            <h4 class="ellipsis" id="details">${item.Memo}</h4>
                            <div class="tagblock">
                                <div class="d-flex flex-row tagBox">
                                    <div class="tag tag-blue">
                                        最新
                                    </div>
                                    <div class="tag tag-green">
                                        國旅卡
                                    </div>
                                    <div class="tag tag-red">
                                        可外帶
                                    </div>
                                    <div class="tag tag-orange">
                                        首賣
                                    </div>
                                </div>
                            </div>
                            <div class="pricewrap">
                                <div class="d-flex flex-row flex-column">
                                    <div class="priceBox ml-auto">
                                        <div class="price d-flex">
                                            <div class="original line-through">
                                                $${item.OriginalPrice}
                                            </div>
                                            <div class="current" id="DiscountPrice">
                                                $${item.DiscountPrice}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="d-flex">
                                    <div class="ml-auto sales-volume">
                                        售44份
                                    </div>
                                </div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-md-7">
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <button class="btn btn-secondary sub_button" id="">
                                                <span class="iconify"
                                                      data-icon="ant-design:minus-outlined"
                                                      data-inline="false"></span>
                                            </button>
                                        </div>
                                        <input type="number" id="cartcount" class="form-control cartcount" value="1">
                                        <div class="input-group-append">
                                            <button class="btn btn-secondary add_button" id="">
                                                <span class="iconify"
                                                      data-icon="codicon:add" data-inline="false"></span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-5">
                                    <button onclick="AddCartEvent()" class="btn btn-block btn-info addCart" id="addCart">加入購買</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    `
                card.innerHTML += html
            }
        }









        //選取元素
        function $g(selector) {
            //判斷是否為id selector
            if (selector.includes('#') && !selector.includes(' ')) {
                //回傳Element
                return document.querySelector(selector);
            }

            //回傳NodeList集合
            let nodelist = document.querySelectorAll(selector);

            return nodelist.length == 1 ? nodelist[0] : nodelist;
        }


    </script>
}